<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sindi - Criar Oferta</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: white;
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 700px;
      margin: 0 auto;
    }
    
    .header {
      background: white;
      border-radius: 28px;
      padding: 32px 28px;
      margin-bottom: 24px;
      box-shadow: 0 15px 45px rgba(0,0,0,0.08);
      text-align: center;
      border: 1px solid #eee;
    }
    
    .logo {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 4px solid #FF6B35;
      margin: 0 auto 16px;
      box-shadow: 0 4px 12px rgba(255,107,53,0.25);
    }
    
    h1 {
      font-size: 28px;
      color: #222;
      margin-bottom: 8px;
      font-weight: 700;
    }
    
    .subtitle {
      color: #666;
      font-size: 16px;
    }
    
    .form-card {
      background: white;
      border-radius: 24px;
      padding: 32px 28px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      border: 1px solid #eee;
      margin-bottom: 24px;
    }
    
    .form-group {
      margin-bottom: 24px;
    }
    
    .form-label {
      display: block;
      font-size: 15px;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
    }
    
    .required {
      color: #FF6B35;
    }
    
    input[type="text"],
    input[type="date"],
    select,
    textarea {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 14px;
      font-size: 15px;
      background: white;
      color: #333;
      transition: all 0.3s;
      font-family: inherit;
    }
    
    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #FF6B35;
      box-shadow: 0 0 0 3px rgba(255,107,53,0.15);
    }
    
    textarea {
      resize: vertical;
      min-height: 100px;
    }
    
    .form-hint {
      font-size: 13px;
      color: #999;
      margin-top: 6px;
    }
    
    .select-wrapper {
      position: relative;
    }
    
    select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23FF6B35' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 16px center;
      padding-right: 45px;
    }
    
    .region-selection {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 12px;
    }
    
    .region-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
    }
    
    .region-item:hover {
      border-color: #FF6B35;
      background: #fff3e0;
    }
    
    .region-item.selected {
      border-color: #FF6B35;
      background: #fff3e0;
    }
    
    .region-checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      flex-shrink: 0;
    }
    
    .region-item.selected .region-checkbox {
      background: #FF6B35;
      border-color: #FF6B35;
    }
    
    .region-checkbox::after {
      content: '‚úì';
      color: white;
      font-weight: bold;
      font-size: 14px;
      opacity: 0;
      transition: opacity 0.2s;
    }
    
    .region-item.selected .region-checkbox::after {
      opacity: 1;
    }
    
    .region-label {
      font-size: 15px;
      color: #333;
      font-weight: 500;
    }
    
    .preview-card {
      background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
      border: 2px solid #FF6B35;
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 24px;
    }
    
    .preview-title {
      font-size: 14px;
      font-weight: 600;
      color: #e65100;
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .preview-content {
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 12px;
      gap: 12px;
    }
    
    .preview-name {
      font-size: 18px;
      font-weight: 700;
      color: #222;
      margin-bottom: 6px;
    }
    
    .preview-category {
      display: inline-block;
      padding: 4px 12px;
      background: #e3f2fd;
      color: #1565c0;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .preview-validity {
      padding: 6px 12px;
      background: #ffebee;
      color: #c62828;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      white-space: nowrap;
    }
    
    .preview-description {
      color: #666;
      font-size: 14px;
      line-height: 1.6;
      margin: 12px 0;
      min-height: 40px;
    }
    
    .preview-region {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: #666;
      margin: 12px 0;
    }
    
    .preview-cta {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #FF6B35 0%, #ff8555 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      margin-top: 16px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .preview-cta:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(255,107,53,0.4);
    }
    
    .btn-submit {
      width: 100%;
      background: linear-gradient(135deg, #FF6B35 0%, #ff8555 100%);
      color: white;
      border: none;
      padding: 16px;
      border-radius: 16px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(255,107,53,0.3);
      transition: all 0.3s;
    }
    
    .btn-submit:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255,107,53,0.4);
    }
    
    .btn-submit:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .success-message {
      background: #e8f5e9;
      border: 2px solid #4caf50;
      color: #2e7d32;
      padding: 16px;
      border-radius: 14px;
      margin-bottom: 24px;
      text-align: center;
      font-weight: 600;
      display: none;
      animation: slideDown 0.3s ease;
    }
    
    .success-message.show {
      display: block;
    }
    
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .error-message {
      background: #ffebee;
      border: 2px solid #f44336;
      color: #c62828;
      padding: 16px;
      border-radius: 14px;
      margin-bottom: 24px;
      text-align: center;
      font-weight: 600;
      display: none;
      animation: slideDown 0.3s ease;
    }
    
    .error-message.show {
      display: block;
    }
    
    .footer {
      text-align: center;
      margin-top: 32px;
      padding: 20px;
      color: #888;
      font-size: 14px;
    }
    
    .footer span {
      color: #FF6B35;
      font-weight: bold;
    }
    
    @media (max-width: 640px) {
      body {
        padding: 12px;
      }
      
      .header {
        border-radius: 20px;
        padding: 24px 20px;
        margin-bottom: 16px;
      }
      
      .logo {
        width: 60px;
        height: 60px;
      }
      
      h1 {
        font-size: 22px;
      }
      
      .subtitle {
        font-size: 14px;
      }
      
      .form-card {
        border-radius: 20px;
        padding: 24px 20px;
        margin-bottom: 16px;
      }
      
      .preview-card {
        border-radius: 16px;
        padding: 20px 16px;
        margin-bottom: 16px;
      }
      
      .preview-content {
        padding: 16px;
      }
      
      .preview-header {
        flex-direction: column;
      }
      
      .preview-validity {
        align-self: flex-start;
      }
      
      .region-selection {
        gap: 10px;
      }
      
      .region-item {
        padding: 10px 14px;
      }
    }
    
    @media (min-width: 641px) {
      .region-selection {
        grid-template-columns: 1fr 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img class="logo" src="https://salvatore.s3.us-east-2.amazonaws.com/sindi/SindiCIrcle.png" alt="Sindi">
      <h1>üéØ Criar Oferta</h1>
      <p class="subtitle">Divulgue seus produtos e servi√ßos para condom√≠nios</p>
    </div>
    
    <div id="successMessage" class="success-message">
      ‚úì Oferta criada com sucesso! Em breve voc√™ come√ßar√° a receber solicita√ß√µes.
    </div>
    
    <div id="errorMessage" class="error-message">
      ‚ùå Erro ao criar oferta. Por favor, tente novamente.
    </div>
    
    <div class="preview-card">
      <div class="preview-title">üì± Pr√©-visualiza√ß√£o da Oferta</div>
      <div class="preview-content">
        <div class="preview-header">
          <div>
            <div class="preview-name" id="previewName">Sua Oferta Aqui</div>
            <span class="preview-category" id="previewCategory">Categoria</span>
          </div>
          <div class="preview-validity" id="previewValidity">‚è∞ Validade</div>
        </div>
        
        <div class="preview-description" id="previewDescription">
          A descri√ß√£o da sua oferta aparecer√° aqui...
        </div>
        
        <div class="preview-region" id="previewRegion">
          üìç <span>Regi√µes atendidas</span>
        </div>
        
        <button class="preview-cta" disabled>
          üìû Solicitar Contato
        </button>
      </div>
    </div>
    
    <div class="form-card">
      <form id="ofertaForm">
        <div class="form-group">
          <label class="form-label">Categoria <span class="required">*</span></label>
          <div class="select-wrapper">
            <select id="categoria" required>
              <option value="">Selecione a categoria</option>
              <option value="Manuten√ß√£o e Reparos">üîß Manuten√ß√£o e Reparos</option>
              <option value="Limpeza">üßπ Limpeza</option>
              <option value="Jardinagem">üå± Jardinagem</option>
              <option value="Seguran√ßa">üõ°Ô∏è Seguran√ßa</option>
              <option value="Pintura">üé® Pintura</option>
              <option value="El√©trica">‚ö° El√©trica</option>
              <option value="Hidr√°ulica">üíß Hidr√°ulica</option>
              <option value="Materiais de Constru√ß√£o">üèóÔ∏è Materiais de Constru√ß√£o</option>
              <option value="Materiais de Limpeza">üßº Materiais de Limpeza</option>
              <option value="Elevadores">üõó Elevadores</option>
              <option value="Portaria e Recep√ß√£o">üö™ Portaria e Recep√ß√£o</option>
              <option value="Tecnologia">üíª Tecnologia</option>
              <option value="Outros">üì¶ Outros</option>
            </select>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Descri√ß√£o da Oferta <span class="required">*</span></label>
          <textarea id="descricao" placeholder="Descreva sua oferta de forma clara e objetiva..." required></textarea>
          <div class="form-hint">M√°ximo 200 caracteres - seja direto e atrativo!</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Regi√µes Atendidas <span class="required">*</span></label>
          <div class="form-hint" style="margin-bottom: 12px;">Selecione todas as regi√µes onde voc√™ pode atender</div>
          <div class="region-selection" id="regionSelection">
            <div class="region-item" data-region="S√£o Jos√© dos Pinhais">
              <div class="region-checkbox"></div>
              <div class="region-label">S√£o Jos√© dos Pinhais</div>
            </div>
            <div class="region-item" data-region="Curitiba">
              <div class="region-checkbox"></div>
              <div class="region-label">Curitiba</div>
            </div>
            <div class="region-item" data-region="Pinhais">
              <div class="region-checkbox"></div>
              <div class="region-label">Pinhais</div>
            </div>
            <div class="region-item" data-region="Colombo">
              <div class="region-checkbox"></div>
              <div class="region-label">Colombo</div>
            </div>
            <div class="region-item" data-region="Arauc√°ria">
              <div class="region-checkbox"></div>
              <div class="region-label">Arauc√°ria</div>
            </div>
            <div class="region-item" data-region="Piraquara">
              <div class="region-checkbox"></div>
              <div class="region-label">Piraquara</div>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Validade da Oferta <span class="required">*</span></label>
          <input type="date" id="validade" required>
          <div class="form-hint">Data at√© quando a oferta estar√° ativa</div>
        </div>
        
        <button type="submit" class="btn-submit" id="submitBtn">
          üöÄ Publicar Oferta
        </button>
      </form>
    </div>
    
    <div class="footer">
      Sindi - Ofertas para Condom√≠nios <span>Sindibot - Impactar LLC</span>
    </div>
  </div>
  
  <script>
    // WEBHOOK: Criar oferta (POST)
    const WEBHOOK_URL = 'https://n8n.polenta.chat/webhook-test/criar-oferta';
    
    const form = document.getElementById('ofertaForm');
    const submitBtn = document.getElementById('submitBtn');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');
    
    // Form inputs
    const categoriaInput = document.getElementById('categoria');
    const descricaoInput = document.getElementById('descricao');
    const validadeInput = document.getElementById('validade');
    
    // Preview elements
    const previewName = document.getElementById('previewName');
    const previewCategory = document.getElementById('previewCategory');
    const previewDescription = document.getElementById('previewDescription');
    const previewRegion = document.getElementById('previewRegion');
    const previewValidity = document.getElementById('previewValidity');
    
    // Selected regions
    let selectedRegions = [];
    
    // Set minimum date to today
    const today = new Date().toISOString().split('T')[0];
    validadeInput.min = today;
    
    // Set default date to 30 days from now
    const futureDate = new Date();
    futureDate.setDate(futureDate.getDate() + 30);
    validadeInput.value = futureDate.toISOString().split('T')[0];
    
    // Region selection
    document.querySelectorAll('.region-item').forEach(item => {
      item.addEventListener('click', function() {
        const region = this.dataset.region;
        
        if (this.classList.contains('selected')) {
          this.classList.remove('selected');
          selectedRegions = selectedRegions.filter(r => r !== region);
        } else {
          this.classList.add('selected');
          selectedRegions.push(region);
        }
        
        updatePreview();
      });
    });
    
    // Update preview on input
    categoriaInput.addEventListener('change', updatePreview);
    descricaoInput.addEventListener('input', updatePreview);
    validadeInput.addEventListener('change', updatePreview);
    
    function updatePreview() {
      // Category
      const categoria = categoriaInput.options[categoriaInput.selectedIndex];
      if (categoria.value) {
        previewName.textContent = categoria.text;
        previewCategory.textContent = categoria.text.substring(categoria.text.indexOf(' ') + 1);
      } else {
        previewName.textContent = 'Sua Oferta Aqui';
        previewCategory.textContent = 'Categoria';
      }
      
      // Description
      const descricao = descricaoInput.value.trim();
      if (descricao) {
        previewDescription.textContent = descricao.substring(0, 200);
      } else {
        previewDescription.textContent = 'A descri√ß√£o da sua oferta aparecer√° aqui...';
      }
      
      // Regions
      if (selectedRegions.length > 0) {
        const regionText = selectedRegions.length === 1 
          ? selectedRegions[0]
          : `${selectedRegions.length} regi√µes selecionadas`;
        previewRegion.innerHTML = `üìç <span>${regionText}</span>`;
      } else {
        previewRegion.innerHTML = `üìç <span>Regi√µes atendidas</span>`;
      }
      
      // Validity
      if (validadeInput.value) {
        const date = new Date(validadeInput.value + 'T00:00:00');
        const formattedDate = date.toLocaleDateString('pt-BR', { 
          day: '2-digit', 
          month: 'short',
          year: 'numeric'
        });
        previewValidity.textContent = `‚è∞ At√© ${formattedDate}`;
      } else {
        previewValidity.textContent = '‚è∞ Validade';
      }
    }
    
    // Character counter for description
    descricaoInput.addEventListener('input', function() {
      if (this.value.length > 200) {
        this.value = this.value.substring(0, 200);
      }
    });
    
    // Form submission
    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // Validate regions
      if (selectedRegions.length === 0) {
        errorMessage.textContent = '‚ùå Selecione pelo menos uma regi√£o atendida';
        errorMessage.classList.add('show');
        setTimeout(() => {
          errorMessage.classList.remove('show');
        }, 5000);
        return;
      }
      
      successMessage.classList.remove('show');
      errorMessage.classList.remove('show');
      
      submitBtn.disabled = true;
      submitBtn.textContent = 'Publicando...';
      
      const formData = {
        categoria: categoriaInput.value,
        descricao: descricaoInput.value.trim(),
        regioes: selectedRegions,
        validade: validadeInput.value,
        timestamp: new Date().toISOString()
      };
      
      try {
        const response = await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });
        
        if (!response.ok) throw new Error('Erro na requisi√ß√£o');
        
        successMessage.classList.add('show');
        form.reset();
        selectedRegions = [];
        document.querySelectorAll('.region-item').forEach(item => {
          item.classList.remove('selected');
        });
        
        // Reset date to 30 days from now
        const futureDate = new Date();
        futureDate.setDate(futureDate.getDate() + 30);
        validadeInput.value = futureDate.toISOString().split('T')[0];
        
        updatePreview();
        
        setTimeout(() => {
          successMessage.classList.remove('show');
        }, 5000);
        
      } catch (error) {
        console.error('Erro:', error);
        errorMessage.textContent = '‚ùå Erro ao criar oferta. Por favor, tente novamente.';
        errorMessage.classList.add('show');
        
        setTimeout(() => {
          errorMessage.classList.remove('show');
        }, 5000);
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'üöÄ Publicar Oferta';
      }
    });
    
    // Initialize preview
    updatePreview();
  </script>
</body>
</html>
