<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sindi - Gerador de Posts</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: white;
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 700px;
      margin: 0 auto;
    }
    
    .header {
      background: white;
      border-radius: 28px;
      padding: 32px 28px;
      margin-bottom: 24px;
      box-shadow: 0 15px 45px rgba(0,0,0,0.08);
      text-align: center;
      border: 1px solid #eee;
    }
    
    .logo {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 4px solid #FF6B35;
      margin: 0 auto 16px;
      box-shadow: 0 4px 12px rgba(255,107,53,0.25);
    }
    
    h1 {
      font-size: 28px;
      color: #222;
      margin-bottom: 8px;
      font-weight: 700;
    }
    
    .subtitle {
      color: #666;
      font-size: 16px;
    }
    
    .form-card {
      background: white;
      border-radius: 24px;
      padding: 32px 28px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
      border: 1px solid #eee;
      margin-bottom: 24px;
    }
    
    .section-title {
      font-size: 20px;
      font-weight: 700;
      color: #FF6B35;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 2px solid #FFE5DD;
    }
    
    .form-group {
      margin-bottom: 24px;
    }
    
    .form-label {
      display: block;
      font-size: 15px;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
    }
    
    .required {
      color: #FF6B35;
    }
    
    input[type="text"],
    input[type="date"],
    input[type="time"],
    select,
    textarea {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 14px;
      font-size: 15px;
      background: white;
      color: #333;
      transition: all 0.3s;
      font-family: inherit;
    }
    
    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #FF6B35;
      box-shadow: 0 0 0 3px rgba(255,107,53,0.15);
    }
    
    textarea {
      resize: vertical;
      min-height: 120px;
    }
    
    .form-hint {
      font-size: 13px;
      color: #999;
      margin-top: 6px;
    }
    
    .image-upload-area {
      border: 3px dashed #e0e0e0;
      border-radius: 14px;
      padding: 32px;
      text-align: center;
      background: #fafafa;
      transition: all 0.3s;
      cursor: pointer;
      position: relative;
    }
    
    .image-upload-area:hover {
      border-color: #FF6B35;
      background: #fff5f2;
    }
    
    .image-upload-area.dragover {
      border-color: #FF6B35;
      background: #fff5f2;
      transform: scale(1.02);
    }
    
    .upload-icon {
      font-size: 48px;
      margin-bottom: 12px;
    }
    
    .upload-text {
      font-size: 16px;
      color: #666;
      margin-bottom: 8px;
      font-weight: 600;
    }
    
    .upload-hint {
      font-size: 13px;
      color: #999;
    }
    
    input[type="file"] {
      display: none;
    }
    
    .image-preview {
      margin-top: 16px;
      display: none;
      position: relative;
    }
    
    .image-preview.show {
      display: block;
    }
    
    .preview-image {
      width: 100%;
      max-height: 400px;
      object-fit: cover;
      border-radius: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .remove-image {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #f44336;
      color: white;
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .remove-image:hover {
      background: #d32f2f;
      transform: scale(1.1);
    }
    
    .checkbox-container {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: #f9f9f9;
      border-radius: 12px;
      margin-top: 12px;
    }
    
    .checkbox-container input[type="checkbox"] {
      width: 22px;
      height: 22px;
      cursor: pointer;
      accent-color: #FF6B35;
    }
    
    .checkbox-container label {
      font-size: 15px;
      color: #444;
      cursor: pointer;
      user-select: none;
    }
    
    .btn-submit {
      width: 100%;
      background: linear-gradient(135deg, #FF6B35 0%, #ff8555 100%);
      color: white;
      border: none;
      padding: 16px;
      border-radius: 16px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(255,107,53,0.3);
      transition: all 0.3s;
      margin-top: 32px;
    }
    
    .btn-submit:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255,107,53,0.4);
    }
    
    .btn-submit:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .success-message {
      background: #e8f5e9;
      border: 2px solid #4caf50;
      color: #2e7d32;
      padding: 16px;
      border-radius: 14px;
      margin-bottom: 24px;
      text-align: center;
      font-weight: 600;
      display: none;
    }
    
    .success-message.show {
      display: block;
      animation: slideDown 0.3s ease;
    }
    
    .error-message {
      background: #ffebee;
      border: 2px solid #f44336;
      color: #c62828;
      padding: 16px;
      border-radius: 14px;
      margin-bottom: 24px;
      text-align: center;
      font-weight: 600;
      display: none;
    }
    
    .error-message.show {
      display: block;
      animation: slideDown 0.3s ease;
    }
    
    .download-link {
      background: linear-gradient(135deg, #E1306C 0%, #C13584 50%, #833AB4 100%);
      border: none;
      color: white;
      padding: 20px;
      border-radius: 16px;
      margin-top: 16px;
      text-align: center;
      display: none;
      box-shadow: 0 6px 20px rgba(225, 48, 108, 0.3);
    }
    
    .download-link.show {
      display: block;
      animation: slideDown 0.3s ease;
    }
    
    .download-link-header {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .download-link a {
      color: white;
      font-weight: 600;
      text-decoration: none;
      font-size: 16px;
      display: inline-block;
      padding: 12px 24px;
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
      transition: all 0.3s;
    }
    
    .download-link a:hover {
      background: rgba(255,255,255,0.3);
      transform: scale(1.05);
    }
    
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .footer {
      text-align: center;
      margin-top: 32px;
      padding: 20px;
      color: #888;
      font-size: 14px;
    }
    
    .footer span {
      color: #FF6B35;
      font-weight: bold;
    }
    
    .select-wrapper {
      position: relative;
    }
    
    select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23FF6B35' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 16px center;
      padding-right: 45px;
    }
    
    .char-counter {
      font-size: 13px;
      color: #999;
      text-align: right;
      margin-top: 6px;
    }
    
    .char-counter.warning {
      color: #ff9800;
      font-weight: 600;
    }
    
    .char-counter.error {
      color: #f44336;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img class="logo" src="https://salvatore.s3.us-east-2.amazonaws.com/sindi/SindiCIrcle.png" alt="Sindi">
      <h1>Gerador de Posts</h1>
      <p class="subtitle">Crie posts profissionais para Instagram em segundos</p>
    </div>
    
    <div id="successMessage" class="success-message">
      Post gerado com sucesso! üéâ
    </div>
    
    <div id="errorMessage" class="error-message">
      Erro ao gerar post. Por favor, tente novamente.
    </div>
    
    <div id="downloadLink" class="download-link">
      <div class="download-link-header">
        <span>üì∏</span>
        <span>Seu post est√° pronto!</span>
      </div>
      <a href="#" target="_blank" id="pngLink">Baixar PNG para Instagram</a>
    </div>
    
    <div class="form-card">
      <form id="postForm">
        <div class="form-group">
          <label class="form-label">Condom√≠nio <span class="required">*</span></label>
          <div class="select-wrapper">
            <select id="condominio" required>
              <option value="">Selecione o condom√≠nio</option>
              <option value="Edif√≠cio Central Park">Edif√≠cio Central Park</option>
              <option value="Residencial Jardins">Residencial Jardins</option>
              <option value="Condom√≠nio Vista Verde">Condom√≠nio Vista Verde</option>
              <option value="Torres do Sol">Torres do Sol</option>
            </select>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Tipo de Aviso <span class="required">*</span></label>
          <div class="select-wrapper">
            <select id="tipoAviso" required>
              <option value="">Selecione o tipo</option>
              <option value="Economia de √Ågua">üíß Economia de √Ågua</option>
              <option value="Falta de Energia">‚ö° Falta de Energia</option>
              <option value="Manuten√ß√£o de Elevador">üîß Manuten√ß√£o de Elevador</option>
              <option value="Limpeza de Caixa d'√Ågua">üö∞ Limpeza de Caixa d'√Ågua</option>
              <option value="Manuten√ß√£o Preventiva">üõ†Ô∏è Manuten√ß√£o Preventiva</option>
              <option value="Pintura Geral">üé® Pintura Geral</option>
              <option value="Assembl√©ia">üìã Assembl√©ia</option>
              <option value="Evento">üéâ Evento</option>
              <option value="Aviso Geral">üì¢ Aviso Geral</option>
              <option value="Outros">üìù Outros</option>
            </select>
          </div>
        </div>
        
        <div class="form-group">
          <label class="form-label">T√≠tulo do Post <span class="required">*</span></label>
          <input type="text" id="titulo" placeholder="Ex: Manuten√ß√£o Programada" maxlength="60" required>
          <div class="form-hint">Seja claro e objetivo (m√°x. 60 caracteres)</div>
          <div class="char-counter" id="tituloCounter">0/60</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Mensagem <span class="required">*</span></label>
          <textarea id="mensagem" placeholder="Digite a mensagem completa do aviso..." maxlength="300" required></textarea>
          <div class="form-hint">Descreva detalhadamente o aviso (m√°x. 300 caracteres)</div>
          <div class="char-counter" id="mensagemCounter">0/300</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Data do Evento/Manuten√ß√£o</label>
          <input type="date" id="dataEvento">
          <div class="form-hint">Opcional - preencha se houver data espec√≠fica</div>
        </div>
        
        <div class="form-group">
          <label class="form-label">Hor√°rio</label>
          <input type="time" id="horario">
          <div class="form-hint">Opcional - preencha se houver hor√°rio espec√≠fico</div>
        </div>
        
        <div class="section-title">üñºÔ∏è Imagem do Post</div>
        
        <div class="form-group">
          <label class="form-label">Adicionar Imagem Personalizada</label>
          <div class="image-upload-area" id="uploadArea">
            <div class="upload-icon">üì∑</div>
            <div class="upload-text">Clique ou arraste uma imagem</div>
            <div class="upload-hint">PNG, JPG ou JPEG (m√°x. 5MB)</div>
          </div>
          <input type="file" id="imageInput" accept="image/png,image/jpeg,image/jpg">
          
          <div class="image-preview" id="imagePreview">
            <img id="previewImg" class="preview-image" alt="Preview">
            <button type="button" class="remove-image" id="removeImage">√ó</button>
          </div>
          
          <div class="checkbox-container">
            <input type="checkbox" id="useGenericImage" checked>
            <label for="useGenericImage">Usar imagem gen√©rica padr√£o do sistema</label>
          </div>
          <div class="form-hint">Se marcado, uma imagem padr√£o ser√° usada caso n√£o envie uma personalizada</div>
        </div>
        
        <button type="submit" class="btn-submit" id="submitBtn">
          Gerar Post para Instagram
        </button>
      </form>
    </div>
    
    <div class="footer">
      Sindi - Gerador de Posts <span>Sindibot - Impactar LLC</span>
    </div>
  </div>
  
  <script>
    var WEBHOOK_URL = 'https://n8n.polenta.chat/webhook-test/instagram-post';
    
    var form = document.getElementById('postForm');
    var submitBtn = document.getElementById('submitBtn');
    var successMessage = document.getElementById('successMessage');
    var errorMessage = document.getElementById('errorMessage');
    var downloadLink = document.getElementById('downloadLink');
    var pngLink = document.getElementById('pngLink');
    
    var uploadArea = document.getElementById('uploadArea');
    var imageInput = document.getElementById('imageInput');
    var imagePreview = document.getElementById('imagePreview');
    var previewImg = document.getElementById('previewImg');
    var removeImageBtn = document.getElementById('removeImage');
    var useGenericImage = document.getElementById('useGenericImage');
    
    var tituloInput = document.getElementById('titulo');
    var mensagemInput = document.getElementById('mensagem');
    var tituloCounter = document.getElementById('tituloCounter');
    var mensagemCounter = document.getElementById('mensagemCounter');
    
    var uploadedImage = null;
    
    tituloInput.addEventListener('input', function() {
      var length = this.value.length;
      tituloCounter.textContent = length + '/60';
      
      if (length > 55) {
        tituloCounter.classList.add('warning');
      } else {
        tituloCounter.classList.remove('warning');
      }
      
      if (length === 60) {
        tituloCounter.classList.add('error');
      } else {
        tituloCounter.classList.remove('error');
      }
    });
    
    mensagemInput.addEventListener('input', function() {
      var length = this.value.length;
      mensagemCounter.textContent = length + '/300';
      
      if (length > 270) {
        mensagemCounter.classList.add('warning');
      } else {
        mensagemCounter.classList.remove('warning');
      }
      
      if (length === 300) {
        mensagemCounter.classList.add('error');
      } else {
        mensagemCounter.classList.remove('error');
      }
    });
    
    uploadArea.addEventListener('click', function() {
      imageInput.click();
    });
    
    uploadArea.addEventListener('dragover', function(e) {
      e.preventDefault();
      this.classList.add('dragover');
    });
    
    uploadArea.addEventListener('dragleave', function(e) {
      e.preventDefault();
      this.classList.remove('dragover');
    });
    
    uploadArea.addEventListener('drop', function(e) {
      e.preventDefault();
      this.classList.remove('dragover');
      
      var files = e.dataTransfer.files;
      if (files.length > 0) {
        handleImageUpload(files[0]);
      }
    });
    
    imageInput.addEventListener('change', function(e) {
      if (e.target.files.length > 0) {
        handleImageUpload(e.target.files[0]);
      }
    });
    
    removeImageBtn.addEventListener('click', function() {
      uploadedImage = null;
      imagePreview.classList.remove('show');
      imageInput.value = '';
      useGenericImage.checked = true;
    });
    
    function handleImageUpload(file) {
      if (!file.type.match('image/(png|jpeg|jpg)')) {
        alert('Por favor, selecione uma imagem PNG, JPG ou JPEG');
        return;
      }
      
      if (file.size > 5 * 1024 * 1024) {
        alert('A imagem deve ter no m√°ximo 5MB');
        return;
      }
      
      var reader = new FileReader();
      reader.onload = function(e) {
        uploadedImage = e.target.result;
        previewImg.src = e.target.result;
        imagePreview.classList.add('show');
        useGenericImage.checked = false;
      };
      reader.readAsDataURL(file);
    }
    
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      
      successMessage.classList.remove('show');
      errorMessage.classList.remove('show');
      downloadLink.classList.remove('show');
      
      submitBtn.disabled = true;
      submitBtn.textContent = 'Gerando post...';
      
      var formData = {
        condominio: document.getElementById('condominio').value,
        tipoAviso: document.getElementById('tipoAviso').value,
        titulo: document.getElementById('titulo').value,
        mensagem: document.getElementById('mensagem').value,
        dataEvento: document.getElementById('dataEvento').value || null,
        horario: document.getElementById('horario').value || null,
        useGenericImage: useGenericImage.checked,
        imagemPersonalizada: uploadedImage,
        timestamp: new Date().toISOString()
      };
      
      fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
      })
      .then(function(response) {
        if (response.ok) {
          return response.json();
        }
        throw new Error('Erro na requisi√ß√£o');
      })
      .then(function(data) {
        successMessage.classList.add('show');
        
        if (data.pngUrl) {
          pngLink.href = data.pngUrl;
          downloadLink.classList.add('show');
        }
        
        form.reset();
        uploadedImage = null;
        imagePreview.classList.remove('show');
        useGenericImage.checked = true;
        tituloCounter.textContent = '0/60';
        mensagemCounter.textContent = '0/300';
        tituloCounter.classList.remove('warning', 'error');
        mensagemCounter.classList.remove('warning', 'error');
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        setTimeout(function() {
          successMessage.classList.remove('show');
        }, 8000);
      })
      .catch(function(error) {
        console.error('Erro:', error);
        errorMessage.classList.add('show');
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        setTimeout(function() {
          errorMessage.classList.remove('show');
        }, 5000);
      })
      .finally(function() {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Gerar Post para Instagram';
      });
    });
  </script>
</body>
</html>
