<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sindi - Cadastro de Fornecedores</title>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: #fff;
      padding: 20px;
    }

    .container { max-width: 700px; margin: 0 auto; }

    .header {
      text-align: center;
      background: #fff;
      border-radius: 28px;
      padding: 32px 28px;
      margin-bottom: 24px;
      box-shadow: 0 15px 45px rgba(0,0,0,.08);
      border: 1px solid #eee;
    }

    .logo {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: 4px solid #FF6B35;
      margin-bottom: 16px;
    }

    h1 { font-size: 28px; font-weight: 700; margin-bottom: 6px; }
    .subtitle { color: #666; font-size: 16px; }

    .form-card {
      background: #fff;
      border-radius: 24px;
      padding: 32px 28px;
      box-shadow: 0 10px 30px rgba(0,0,0,.08);
      border: 1px solid #eee;
    }

    .form-group { margin-bottom: 24px; }

    .form-label {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 8px;
      display: block;
    }

    .required { color: #FF6B35; }

    input, select {
      width: 100%;
      padding: 14px 16px;
      border-radius: 14px;
      border: 2px solid #e0e0e0;
      font-size: 15px;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #FF6B35;
      box-shadow: 0 0 0 3px rgba(255,107,53,.15);
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 24px;
    }

    @media (min-width: 640px) {
      .form-grid { grid-template-columns: 1fr 1fr; }
    }

    .radio-group {
      display: flex;
      gap: 20px;
      margin-top: 8px;
    }

    .btn-submit {
      width: 100%;
      background: linear-gradient(135deg, #FF6B35, #ff8555);
      border: none;
      color: white;
      padding: 16px;
      border-radius: 16px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 24px;
    }

    .btn-submit.secondary {
      background: #ccc;
      color: #333;
    }

    .success-message, .error-message {
      display: none;
      padding: 16px;
      border-radius: 14px;
      text-align: center;
      font-weight: 600;
      margin-bottom: 20px;
    }

    .success-message { background: #e8f5e9; color: #2e7d32; }
    .error-message { background: #ffebee; color: #c62828; }

    /* Modal */
    #confirmModal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.6);
      display: none;
      z-index: 999;
    }

    .modal-box {
      background: white;
      max-width: 500px;
      margin: 10vh auto;
      padding: 24px;
      border-radius: 20px;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }
  </style>
</head>

<body>
<div class="container">

  <div class="header">
    <img class="logo" src="https://salvatore.s3.us-east-2.amazonaws.com/sindi/SindiCIrcle.png" alt="Sindi"/>
    <h1>Cadastro de Fornecedores</h1>
    <p class="subtitle">Registre fornecedores de produtos e serviços</p>
  </div>

  <div id="successMessage" class="success-message">Fornecedor cadastrado com sucesso!</div>
  <div id="errorMessage" class="error-message">Erro ao cadastrar fornecedor.</div>

  <div class="form-card">
    <form id="fornecedorForm">

      <!-- Categoria -->
      <div class="form-group">
        <label class="form-label">Categoria <span class="required">*</span></label>
        <select id="categoria" required>
          <option value="">Selecione</option>
          <option>Elétrica</option>
          <option>Hidráulica</option>
          <option>Limpeza</option>
          <option>Obras / Reformas</option>
          <option>Segurança</option>
        </select>
      </div>

      <!-- Nome Fornecedor -->
      <div class="form-group">
        <label class="form-label">Nome do Fornecedor <span class="required">*</span></label>
        <input type="text" id="nomeFornecedor" required />
      </div>

      <!-- Tipo Pessoa -->
      <div class="form-group">
        <label class="form-label">Tipo de Fornecedor</label>
        <div class="radio-group">
          <label><input type="radio" name="tipoPessoa" value="juridica"> Pessoa Jurídica</label>
          <label><input type="radio" name="tipoPessoa" value="fisica"> Pessoa Física</label>
        </div>
      </div>

      <!-- CPF / CNPJ -->
      <div class="form-group" id="cnpjGroup" style="display:none;">
        <label class="form-label">CNPJ</label>
        <input type="text" id="cnpj"/>
      </div>

      <div class="form-group" id="cpfGroup" style="display:none;">
        <label class="form-label">CPF</label>
        <input type="text" id="cpf"/>
      </div>

      <!-- Endereço -->
      <div class="form-group">
        <label class="form-label">Endereço</label>
        <input type="text" id="endereco"/>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label class="form-label">Cidade <span class="required">*</span></label>
          <input type="text" id="cidade" required/>
        </div>

        <div class="form-group">
          <label class="form-label">Estado <span class="required">*</span></label>
          <select id="estado" required>
            <option value="">Selecione</option>
            <option>PR</option><option>SP</option><option>RJ</option>
            <option>SC</option><option>RS</option><option>MG</option>
          </select>
        </div>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label class="form-label">Nome do Contato</label>
          <input type="text" id="nomeContato"/>
        </div>

        <div class="form-group">
          <label class="form-label">Telefone <span class="required">*</span></label>
          <input type="tel" id="telefone" required/>
        </div>
      </div>

      <button type="submit" class="btn-submit">Cadastrar Fornecedor</button>
    </form>
  </div>
</div>

<!-- Modal Confirmação -->
<div id="confirmModal">
  <div class="modal-box">
    <h3>Confirme os dados</h3>
    <div id="confirmData" style="margin-top:16px;font-size:14px;"></div>

    <div class="modal-actions">
      <button class="btn-submit secondary" id="btnCorrigir">Corrigir</button>
      <button class="btn-submit" id="btnConfirmar">Cadastrar</button>
    </div>
  </div>
</div>

<script>
const form = document.getElementById('fornecedorForm');
const modal = document.getElementById('confirmModal');
const confirmData = document.getElementById('confirmData');
let payload = null;

document.querySelectorAll('input[name="tipoPessoa"]').forEach(r => {
  r.addEventListener('change', e => {
    document.getElementById('cnpjGroup').style.display = e.target.value === 'juridica' ? 'block' : 'none';
    document.getElementById('cpfGroup').style.display  = e.target.value === 'fisica' ? 'block' : 'none';
  });
});

form.addEventListener('submit', e => {
  e.preventDefault();

  const tipoPessoa = document.querySelector('input[name="tipoPessoa"]:checked')?.value || null;

  payload = {
    categoria: categoria.value,
    nomeFornecedor: nomeFornecedor.value,
    tipoPessoa,
    documento: tipoPessoa === 'juridica' ? cnpj.value : tipoPessoa === 'fisica' ? cpf.value : null,
    endereco: endereco.value,
    cidade: cidade.value,
    estado: estado.value,
    nomeContato: nomeContato.value,
    telefone: telefone.value
  };

  confirmData.innerHTML = Object.entries(payload)
    .map(([k,v]) => `<strong>${k}:</strong> ${v || '—'}`)
    .join('<br>');

  modal.style.display = 'block';
});

btnCorrigir.onclick = () => modal.style.display = 'none';

btnConfirmar.onclick = () => {
  modal.style.display = 'none';
  fetch('https://n8n.polenta.chat/webhook-test/cadastro-fornecedor', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify(payload)
  }).then(() => {
    successMessage.style.display='block';
    form.reset();
  }).catch(()=>errorMessage.style.display='block');
};
</script>

</body>
</html>
