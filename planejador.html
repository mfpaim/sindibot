<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Planejador Estratégico • Sindi Coruja</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  :root { --laranja:#FF6B35; --roxo:#635bff; --verde:#10b981; --cinza:#f3f4f6;}
  body {margin:0; font-family:system-ui,-apple-system,sans-serif; background:#f9fafb; color:#1f2937; line-height:1.5}
  .container {max-width:860px; margin:20px auto; padding:0 16px}
  header {text-align:center; padding:32px 20px; background:white; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.08); margin-bottom:30px}
  .coruja {width:100px; height:100px; border:5px solid var(--laranja); border-radius:50%; box-shadow:0 8px 25px rgba(255,107,53,0.3)}
  h1 {margin:16px 0 8px; font-size:28px; color:#111}
  .subtitle {color:#666; font-size:17px}
  
  .botoes {text-align:center; margin:20px 0}
  .add-btn, .pdf-btn {
    background:var(--laranja); color:white; border:none; padding:14px 28px; border-radius:50px; font-size:16px; cursor:pointer; font-weight:600; margin:0 8px}
  .pdf-btn {background:#10b981}
  .pdf-btn:hover {background:#059669}

  .demanda {background:white; border-radius:16px; padding:20px; margin-bottom:16px; box-shadow:0 4px 15px rgba(0,0,0,0.06); position:relative}
  .delete {position:absolute; top:16px; right:16px; background:none; border:none; font-size:24px; cursor:pointer; color:#999}
  .titulo {font-size:19px; font-weight:600; margin:0 0 12px; color:#111}
  .tags {display:flex; flex-wrap:wrap; gap:8px; margin:12px 0}
  .tag {padding:5px 12px; border-radius:20px; font-size:13px; font-weight:600}
  .baixa {background:#dbeafe; color:#4338ca}
  .media {background:#fef3c7; color:#92400e}
  .alta {background:#fee2e2; color:#991b1b}
  .critica {background:#FECACA; color:#7f1d1d; animation:pulse 2s infinite}
  .estetica {background:#f0e6ff; color:#6b21a8}
  .seguranca {background:#fecaca; color:#991b1b}
  .lazer {background:#d1fae5; color:#065f46}
  .manutencao {background:#dbeafe; color:#1e40af}
  .legal {background:#ffedd5; color:#9a3412}

  .fila {margin-top:40px}
  .item {background:white; border-radius:16px; padding:20px; margin-bottom:16px; box-shadow:0 6px 20px rgba(0,0,0,0.08); border-left:6px solid var(--laranja)}
  .rank {font-size:36px; font-weight:800; color:var(--laranja); display:inline-block; width:60px}
  .score {font-size:14px; color:#666}

  .insights {background:linear-gradient(135deg,#635bff,#4f46e6); color:white; padding:24px; border-radius:20px; margin:40px 0}
  .insights h3 {margin:0 0 12px; font-size:20px}

  @keyframes pulse {0%{box-shadow:0 0 0 0 rgba(255,107,53,0.4)}70%{box-shadow:0 0 0 10px rgba(255,107,53,0)}100%{box-shadow:0 0 0 0 rgba(255,107,53,0)}}

  /* ESTILO PARA IMPRESSÃO / PDF */
  @media print {
    body {background:white; margin:0; padding:20px}
    .container {max-width:none; margin:0; padding:0}
    header, .botoes, .delete {display:none !important}
    .demanda, .item {box-shadow:none; page-break-inside:avoid; border:1px solid #eee; margin:15px 0}
    .insights {background:#635bff !important; -webkit-print-color-adjust:exact; color-adjust:exact}
    h1 {font-size:26px; margin-top:0}
    .rank {color:var(--laranja) !important; -webkit-print-color-adjust:exact}
  }
</style>
</head>
<body>

<div class="container">
  <header>
    <img src="https://salvatore.s3.us-east-2.amazonaws.com/sindi/SindiCIrcle.png" class="coruja" alt="Sindi">
    <h1>Planejador Estratégico para Síndicos</h1>
    <p class="subtitle">Seu segundo cérebro – prioriza o que realmente importa</p>
  </header>

  <div class="botoes">
    <button class="add-btn" onclick="novaDemanda()">+ Nova Demanda</button>
    <button class="pdf-btn" onclick="window.print()">Exportar em PDF</button>
  </div>

  <div id="listaDemandas"></div>

  <div class="fila">
    <h2>Fila de Priorização Inteligente</h2>
    <div id="fila"></div>
  </div>

  <div class="insights" id="insights" style="display:none">
    <h3>Insights Estratégicos da Coruja</h3>
    <ul id="listaInsights"></ul>
  </div>
</div>

<script>
const demandas = [];

function novaDemanda() {
  const titulo = prompt("Título da demanda", "")?.trim();
  if (!titulo) return;

  const urgencia = prompt("Urgência\nBaixa • Média • Alta • Crítica", "Média")?.trim().toLowerCase() || "média";
  const impacto = prompt("Impacto principal\nEstética • Segurança • Lazer • Manutenção • Obrigação Legal", "Manutenção")?.trim() || "Manutenção";
  const moradores = parseInt(prompt("Quantos moradores afetados?", "50")) || 0;
  const legal = confirm("É Obrigação legal?");

  demandas.push({titulo, urgencia, impacto, moradores, legal, id:Date.now()});
  atualizarTudo();
}

function calcularScore(d) {
  let score = 0;
  if (d.urgencia === "crítica") score += 50;
  else if (d.urgencia === "alta") score += 30;
  else if (d.urgencia === "média") score += 10;

  if (d.legal) score += 40;
  if (d.impacto.toLowerCase().includes("segurança")) score += 35;
  if (d.impacto.toLowerCase().includes("legal")) score += 30;
  score += Math.min(d.moradores / 2, 30);
  return Math.min(score, 100);
}

function tagClass(valor, tipo) {
  const map = {
    urgencia: {baixa:"baixa", média:"media", alta:"alta", crítica:"critica"},
    impacto: {"estética":"estetica", "segurança":"seguranca", "lazer":"lazer", "manutenção":"manutencao", "obrigação legal":"legal"}
  };
  return map[tipo][valor.toLowerCase()] || "media";
}

function atualizarTudo() {
  // lista de demandas cadastradas
  let html = "";
  demandas.forEach(d => {
    html += `
      <div class="demanda">
        <button class="delete" onclick="remover(${d.id})">×</button>
        <div class="titulo">${d.titulo}</div>
        <div class="tags">
          <span class="tag ${tagClass(d.urgencia,'urgencia')}">${d.urgencia.toUpperCase()}</span>
          <span class="tag ${tagClass(d.impacto,'impacto')}">${d.impacto}</span>
          <span class="tag">${d.moradores} moradores</span>
          ${d.legal ? '<span class="tag legal">OBRIGAÇÃO LEGAL</span>' : ''}
        </div>
      </div>`;
  });
  document.getElementById("listaDemandas").innerHTML = html || "<p style='text-align:center;color:#999'>Nenhuma demanda ainda</p>";

  // fila inteligente
  const ordenadas = [...demandas].sort((a,b) => calcularScore(b) - calcularScore(a));
  let filaHtml = "";
  ordenadas.forEach((d,i) => {
    const score = calcularScore(d);
    filaHtml += `
      <div class="item">
        <span class="rank">#${i+1}</span>
        <strong>${d.titulo}</strong>
        <div class="tags">
          <span class="tag ${tagClass(d.urgencia,'urgencia')}">${d.urgencia}</span>
          <span class="tag ${tagClass(d.impacto,'impacto')}">${d.impacto}</span>
          <span class="tag">${d.moradores} moradores</span>
          ${d.legal ? '<span class="tag legal">LEGAL</span>' : ''}
        </div>
        <div><strong style="color:${score>=80?'#dc2626':score>=50?'#f59e0b':'#6b7280'}">Score: ${score}</strong>
        ${score>=70?' <span style="color:#dc2626">CRÍTICO</span>':''}
      </div>`;
  });
  document.getElementById("fila").innerHTML = filaHtml || "<p style='color:#999'>Adicione demandas para ver a fila</p>";

  // insights
  const criticas = demandas.filter(d=>d.urgencia==="crítica").length;
  const legais = demandas.filter(d=>d.legal).length;
  const seguranca = demandas.filter(d=>d.impacto.toLowerCase().includes("segurança")).length;

  let insights = [];
  if (legais>0) insights.push("Priorizar obrigações legais para evitar multas e problemas jurídicos");
  if (criticas>0) insights.push(`Atenção: ${criticas} item(s) CRÍTICO(S) na fila`);
  if (seguranca>0) insights.push("Segurança em primeiro lugar – execute logo");
  if (demandas.length>6) insights.push("Foque nas 3 primeiras da fila");

  if (insights.length===0) insights.push("Tudo sob controle! Continue acompanhando");

  document.getElementById("listaInsights").innerHTML = insights.map(t=>`<li>${t}</li>`).join("");
  document.getElementById("insights").style.display = demandas.length > 0 ? "block" : "none";
}

function remover(id) {
  const i = demandas.findIndex(d=>d.id===id);
  if(i!==-1) demandas.splice(i,1);
  atualizarTudo();
}

atualizarTudo();
</script>
</body>
</html>
